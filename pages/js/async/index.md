# 异步发展

## 图例

![异步](../../imgs/async.webp)

---

## callback 的问题

-   线性理解能力缺失，回调地狱，过深的嵌套，导致回调地狱，难以追踪回调的执行顺序。
-   控制反转信任缺失，错误处理无法保证
    回调函数的调用逻辑是在请求函数内部，我们无法保证回调函数一定会被正确调用。回调本身没有错误处理机制，需要额外设计。可能出现的错误包括：回调返回错误结果、吞掉可能出现的错误与异常、回调没有执行、回调被多次执行、回调被同步执行等等。

---

## Promise

### 基本使用

```js
let p = new Promise((resolve, reject) => {
    if (error) {
        reject(error);
    } else {
        resolve(data);
    }
});

p.then(
    res => {},
    error => {}
);
```
